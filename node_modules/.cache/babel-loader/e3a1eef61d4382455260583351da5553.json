{"ast":null,"code":"import { call, put, takeLatest } from \"redux-saga/effects\";\nimport { fetchChatApi1, fetchChatApi2 } from \"../../api\";\nimport { WATCH_CHAT_MEMBERS, WATCH_CHAT_SUCCESS, SEND_MESSAGE_WATCHER, REPLY_MESSAGE_WATCHER, CREATE_CHAT_WATCHER } from \"../../redux/actionTypes\";\nimport { getMembersSuccess, sendMessageToChat, replyMessageToChat, getChats, getChatsSuccess, updateSelectedUser, createChat } from \"../../redux/chap-app/action\";\nfunction* fetchChatMemberAsyn() {\n  const chatData = yield call(fetchChatApi1);\n  yield put(getMembersSuccess(chatData.data));\n}\nfunction* fetchChatAsyn() {\n  const chatData = yield call(fetchChatApi2);\n  const currentUserId = 0;\n  yield put(getChats(chatData.data));\n  const online = true;\n  const chats = chatData.data;\n  const chat = chats.data.filter(x => x.users.includes(currentUserId));\n  const selectedUser = chats.data[0].users.find(x => x !== currentUserId);\n  yield put(getChatsSuccess(chat, selectedUser, online));\n  yield put(updateSelectedUser(selectedUser, online));\n}\nfunction sendMessageAsyn(_ref) {\n  let {\n    currentUserId,\n    selectedUserId,\n    messageInput,\n    chats,\n    online\n  } = _ref;\n  return function* () {\n    let chat = chats.find(x => x.users.includes(currentUserId) && x.users.includes(selectedUserId));\n    const now = new Date();\n    const time = now.getHours() + \":\" + now.getMinutes();\n    const status = online;\n    if (chat) {\n      chat.messages.push({\n        sender: currentUserId,\n        time: time,\n        text: messageInput,\n        status: true\n      });\n      chat.lastMessageTime = time;\n      chat.online = status;\n      let chats_data = chats.filter(x => x.id !== chat.id);\n      chats_data.splice(0, 0, chat);\n      yield put(getChatsSuccess(chats, selectedUserId, online));\n    }\n    yield put(sendMessageToChat(currentUserId, selectedUserId, messageInput, chats, online));\n  }();\n}\nfunction replyByUserAsyn(_ref2) {\n  let {\n    currentUserId,\n    selectedUserId,\n    replyMessage,\n    chats,\n    online\n  } = _ref2;\n  return function* () {\n    let chat = chats.find(x => x.users.includes(currentUserId) && x.users.includes(selectedUserId));\n    const now = new Date();\n    const time = now.getHours() + \":\" + now.getMinutes();\n    const status = online;\n    if (chat) {\n      chat.messages.push({\n        sender: selectedUserId,\n        time: time,\n        text: replyMessage,\n        status: true\n      });\n      chat.lastMessageTime = time;\n      chat.online = status;\n      let chats_data = chats.filter(x => x.id !== chat.id);\n      chats_data.splice(0, 0, chat);\n      yield put(getChatsSuccess(chats_data, selectedUserId, online));\n    }\n    yield put(replyMessageToChat(currentUserId, selectedUserId, replyMessage, chats, online));\n  }();\n}\nfunction createNewChatAsyn(_ref3) {\n  let {\n    currentUserId,\n    selectedUserId,\n    chats\n  } = _ref3;\n  return function* () {\n    yield put(createChat(currentUserId, selectedUserId, chats));\n    let conversation = {\n      id: chats.length + 1,\n      users: [currentUserId, selectedUserId],\n      lastMessageTime: \"-\",\n      messages: []\n    };\n    chats.splice(0, 0, conversation);\n    yield put(getChatsSuccess(chats, selectedUserId));\n  }();\n}\nexport function* WatcherChatApp() {\n  yield takeLatest(WATCH_CHAT_MEMBERS, fetchChatMemberAsyn);\n  yield takeLatest(WATCH_CHAT_SUCCESS, fetchChatAsyn);\n  yield takeLatest(SEND_MESSAGE_WATCHER, sendMessageAsyn);\n  yield takeLatest(REPLY_MESSAGE_WATCHER, replyByUserAsyn);\n  yield takeLatest(CREATE_CHAT_WATCHER, createNewChatAsyn);\n}","map":{"version":3,"names":["call","put","takeLatest","fetchChatApi1","fetchChatApi2","WATCH_CHAT_MEMBERS","WATCH_CHAT_SUCCESS","SEND_MESSAGE_WATCHER","REPLY_MESSAGE_WATCHER","CREATE_CHAT_WATCHER","getMembersSuccess","sendMessageToChat","replyMessageToChat","getChats","getChatsSuccess","updateSelectedUser","createChat","fetchChatMemberAsyn","chatData","data","fetchChatAsyn","currentUserId","online","chats","chat","filter","x","users","includes","selectedUser","find","sendMessageAsyn","selectedUserId","messageInput","now","Date","time","getHours","getMinutes","status","messages","push","sender","text","lastMessageTime","chats_data","id","splice","replyByUserAsyn","replyMessage","createNewChatAsyn","conversation","length","WatcherChatApp"],"sources":["/home/rifat/uk client/garage/garage-frontend-2/theme/src/redux/chap-app/index.js"],"sourcesContent":["import {call,put, takeLatest} from \"redux-saga/effects\";\nimport { fetchChatApi1,fetchChatApi2 } from \"../../api\";\nimport { WATCH_CHAT_MEMBERS,WATCH_CHAT_SUCCESS,SEND_MESSAGE_WATCHER,REPLY_MESSAGE_WATCHER,CREATE_CHAT_WATCHER } from \"../../redux/actionTypes\";\nimport { getMembersSuccess,sendMessageToChat,replyMessageToChat,getChats,getChatsSuccess,updateSelectedUser,createChat} from \"../../redux/chap-app/action\";\n\n\nfunction* fetchChatMemberAsyn() {\n    const chatData = yield call(fetchChatApi1);\n    yield put(getMembersSuccess(chatData.data));\n}\n\nfunction* fetchChatAsyn() {\n\n    const chatData = yield call(fetchChatApi2);\n    const currentUserId = 0;\n    yield put(getChats(chatData.data));\n    const online = true;\n    const chats = chatData.data;\n    const chat = chats.data.filter(x => x.users.includes(currentUserId));\n    const selectedUser = chats.data[0].users.find(x => x !== currentUserId);\n    yield put(getChatsSuccess(chat,selectedUser,online))\n    yield put(updateSelectedUser(selectedUser,online))\n}\n\nfunction* sendMessageAsyn({currentUserId, selectedUserId, messageInput, chats, online}) {\n\n     let chat = chats.find(x => x.users.includes(currentUserId) && x.users.includes(selectedUserId))\n     const now = new Date();\n     const time =  now.getHours() + \":\" + now.getMinutes();\n     const status=online\n     if (chat) {\n         chat.messages.push({\n             sender: currentUserId,\n             time: time,\n             text: messageInput,\n             status:true\n         });\n         chat.lastMessageTime = time;\n         chat.online = status;\n         \n         let chats_data = (chats.filter(x => x.id !== chat.id));\n         chats_data.splice(0, 0, chat)\n         yield put(getChatsSuccess(chats,selectedUserId,online))  \n    }\n    yield put(sendMessageToChat(currentUserId,selectedUserId,messageInput,chats,online))  \n}\n\nfunction* replyByUserAsyn({currentUserId, selectedUserId, replyMessage, chats, online}) {\n  \n    let chat = chats.find(x => x.users.includes(currentUserId) && x.users.includes(selectedUserId))\n    const now = new Date();\n    const time =  now.getHours() + \":\" + now.getMinutes();\n    const status= online\n    if (chat) {\n        chat.messages.push({\n            sender: selectedUserId,\n            time: time,\n            text: replyMessage,\n            status:true\n        });\n        chat.lastMessageTime = time;\n        chat.online = status;\n        let chats_data = (chats.filter(x => x.id !== chat.id));\n        chats_data.splice(0, 0, chat)\n\n        yield put(getChatsSuccess(chats_data,selectedUserId,online));\n    }\n    yield put(replyMessageToChat(currentUserId, selectedUserId, replyMessage, chats, online));\n}\n\nfunction* createNewChatAsyn({currentUserId, selectedUserId, chats}) {\n\n    yield put(createChat(currentUserId, selectedUserId, chats))\n    let conversation = {\n        id: chats.length + 1,\n        users: [currentUserId, selectedUserId],\n        lastMessageTime: \"-\",\n        messages: []\n    };\n    chats.splice(0, 0, conversation)\n    yield put(getChatsSuccess(chats,selectedUserId))\n}\n\nexport function* WatcherChatApp() {\n    yield takeLatest(WATCH_CHAT_MEMBERS,fetchChatMemberAsyn)\n    yield takeLatest(WATCH_CHAT_SUCCESS,fetchChatAsyn)\n    yield takeLatest(SEND_MESSAGE_WATCHER,sendMessageAsyn)\n    yield takeLatest(REPLY_MESSAGE_WATCHER,replyByUserAsyn)\n    yield takeLatest(CREATE_CHAT_WATCHER, createNewChatAsyn)\n}\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}